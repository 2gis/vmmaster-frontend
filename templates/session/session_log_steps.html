{% if log_steps %}
    {% load session_filters %}
    {% load session_tags %}
    {% groupify log_steps as steps_groups %}
    <div class="log_steps">
    {% for group in steps_groups.items %}
        {% if "vmmasterLabel" in group.1.0.control_line %}
            {% for step in group.1 %}
            {% if forloop.first %}
            <div id="{{ step.id }}" class="log_step label_group">
                <a href="javascript: open_group('{{step.id}}')" title="{{ step.body|extract_label }}">
                    <h4 class="group_log_step">{{ step.body|extract_label|truncate_string:80 }}</h4>
                </a>
                <div class="group _disabled">
            {% else %}
                <div id="{{ step.id }}" class="log_step {{ step.response_status|code_status }} {{ step.control_line|label_step }}">
                    <div class="expand log_step_column">
                        {% if step|got_sub_steps %}
                        <div class="expandglyph glyphicon glyphicon-chevron-right"></div>
                        {% else %}
                        <div class="glyphicon glyphicon-none"></div>
                        {% endif %}
                    </div>
                    <a href="session_step/{{ step.id }}" title="{{ step.control_line }}"><div class="log_step_column log_request">{{ step.control_line|truncate_string }}</div></a>
                    <div class="log_step_column log_body" data-toggle="tooltip" title="{{ step.body }}">{{ step.body|truncate_string }}</div>
                    <div class="log_step_column log_time">{{ step.total_time }} sec.</div>
                    {% show_screenshot step %}
                    <div class="info"></div>
                </div>
            {% endif %}
            {% endfor %}
                </div>
            </div>
        {% else %}
            {% for step in group.1 %}
            <div id="{{ step.id }}" class="log_step {{ step.response_status|code_status }} {{ step.control_line|label_step }}">
                <div class="expand log_step_column">
                    {% if step|got_sub_steps %}
                    <div class="expandglyph glyphicon glyphicon-chevron-right"></div>
                    {% else %}
                    <div class="glyphicon glyphicon-none"></div>
                    {% endif %}
                </div>
                {% if step.control_line|label_step %}
                    <h4><a href="session_step/{{ step.id }}" title="{{ step.body|extract_label }}">{{ step.body|extract_label|truncate_string:80 }}</a></h4>
                {% else %}
                    <a href="session_step/{{ step.id }}" title="{{ step.control_line }}"><div class="log_step_column log_request">{{ step.control_line|truncate_string }}</div></a>
                    <div class="log_step_column log_body" data-toggle="tooltip" title="{{ step.body }}">{{ step.body|truncate_string }}</div>
                    <div class="log_step_column log_time">{{ step.total_time }} sec.</div>
                    {% show_screenshot step %}
                    <div class="info"></div>
                {% endif %}
            </div>
            {% endfor %}
        {% endif %}
    {% endfor %}
    </div>
    {% show_modal_window log_steps %}
{% else %}
    <div class="well">No log steps.</div>
{% endif %}